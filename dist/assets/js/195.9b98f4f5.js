(window.webpackJsonp=window.webpackJsonp||[]).push([[195],{668:function(s,a,t){"use strict";t.r(a);var e=t(21),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"source-map"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#source-map"}},[s._v("#")]),s._v(" Source Map")]),s._v(" "),t("h2",{attrs:{id:"生产环境遇到的问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生产环境遇到的问题"}},[s._v("#")]),s._v(" 生产环境遇到的问题")]),s._v(" "),t("p",[s._v("前端项目在投入生产环境之前，都需要对 JavaScript 源代码进行压缩混淆，从而减小文件的体积，提高文件的 加载效率。此时就不可避免的产生了另一个问题：")]),s._v(" "),t("p",[s._v("**对压缩混淆之后的代码除错（debug）**是一件极其困难的事情")]),s._v(" "),t("ul",[t("li",[s._v("变量被替换成没有任何语义的名称")]),s._v(" "),t("li",[s._v("空行和注释被剔除")])]),s._v(" "),t("h2",{attrs:{id:"什么是-source-map"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是-source-map"}},[s._v("#")]),s._v(" 什么是 Source Map")]),s._v(" "),t("p",[t("strong",[s._v("Source Map 就是一个信息文件，里面储存着位置信息")]),s._v("。也就是说，Source Map 文件中存储着压缩混淆后的代码，所对应的转换前的位置。")]),s._v(" "),t("p",[s._v("有了它，出错的时候，除错工具将"),t("strong",[s._v("直接显示原始代码，而不是转换后的代码")]),s._v("，能够极大的方便后期的调试")]),s._v(" "),t("h2",{attrs:{id:"webpack-开发环境下的-source-map"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webpack-开发环境下的-source-map"}},[s._v("#")]),s._v(" webpack 开发环境下的 Source Map")]),s._v(" "),t("p",[s._v("在"),t("strong",[s._v("开发环境下")]),s._v("，webpack 默认启用了 Source Map 功能。当程序运行出错时，可以直接在控制台提示错误行的位置，并定位到具体的源代码.")]),s._v(" "),t("p",[s._v("解决默认 Source Map 的问题:")]),s._v(" "),t("p",[t("strong",[s._v("开发环境下")]),s._v("，推荐在 webpack.config.js 中添加如下的配置，即可保证运行时报错的行数与源代码的行数保持一致")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  mode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"development"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  devtool"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eval-source-map"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("在生产环境下")]),s._v("，如果"),t("strong",[s._v("省略了 devtool 选项")]),s._v("，则最终生成的文件中不包含 Source Map。这能够"),t("strong",[s._v("防止原始代码通过 Source Map 的形式暴露")]),s._v("给别有所图之人")]),s._v(" "),t("blockquote",[t("p",[s._v("正式发布，关闭 devtool，但是并不方便")])]),s._v(" "),t("p",[t("strong",[s._v("只定位行数不暴露源码")]),s._v("：")]),s._v(" "),t("p",[t("strong",[s._v("在生产环境下")]),s._v("，如果"),t("strong",[s._v("只想定位报错的具体行数")]),s._v("，且不想暴露源码。此时可以将 devtool 的值设置为 nosources-source-map。")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  mode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"development"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  devtool"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nosources-source-map"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("采用此选项后：你应该将你的服务器配置为，不允许普通用户访问 source map 文件！")]),s._v(" "),t("h2",{attrs:{id:"source-map-总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#source-map-总结"}},[s._v("#")]),s._v(" Source Map 总结")]),s._v(" "),t("p",[s._v("开发环境下：")]),s._v(" "),t("ul",[t("li",[s._v("建议把 devtool 的值设置为 eval-source-map")]),s._v(" "),t("li",[s._v("好处：可以精准定位到具体的错误行")])]),s._v(" "),t("p",[s._v("生产环境下：")]),s._v(" "),t("ul",[t("li",[s._v("建议关闭 Source Map 或将 devtool 的值设置为 nosources-source-map")]),s._v(" "),t("li",[s._v("好处：防止源码泄露，提高网站的安全性")])])])}),[],!1,null,null,null);a.default=r.exports}}]);